"use client";

import { FeedbackApi, PropsWithClassName, RegionKey, Story } from "@/types";
import { useTranslations } from "next-intl";
import Image from "next/image";
import { Swiper, SwiperSlide } from "swiper/react";
import { Pagination } from "swiper/modules";
import { AnimatePresence, motion } from "motion/react";
import { cn } from "@/lib/utils";
import { Title, RegionSelect } from "@/components/custom";
import { useState } from "react";
import { useRegionStore } from "@/stores/region";

type StoriesProps = {
  data:
    | FeedbackApi
    | {
        error: string | null;
      };
};

const Stories = ({ data }: StoriesProps) => {
  const region = useRegionStore((state) => state.region);
  const t = useTranslations();

  if (data.error) {
    return (
      <div className={cn("container flex flex-col gap-5 md:gap-8")}>
        <Title className="w-fit max-w-max">{t("home.stories.title")}</Title>
        <p className="text-pink-main">{data.error}</p>
      </div>
    );
  }

  const stories =
    region && !data.error
      ? (data as FeedbackApi)[region]
        ? (data as FeedbackApi)[region]
        : []
      : [];

  if (region === null) return null;

  return (
    <div className="container flex flex-col gap-5 md:gap-8">
      <div className="flex max-lg:flex-col lg:items-center justify-between gap-4">
        <div className="flex max-sm:flex-col sm:items-center gap-4 w-full md:w-[35rem] lg:w-1/2">
          <Title className="w-fit max-w-max">{t("home.stories.title")}</Title>

          <RegionSelect color="white" className="flex-1" />
        </div>
        <p className="w-full lg:w-2/5 text-sm md:text-base text-dark-blue-400">
          {t("home.stories.description")}
        </p>
      </div>

      <AnimatePresence>
        {stories.length > 0 && <StorySlider data={stories} />}
      </AnimatePresence>

      <Map className="max-md:hidden max-w-[45rem] w-full mx-auto" />
    </div>
  );
};

export default Stories;

type StorySliderProps = { data: Story[] };

const StorySlider = ({ data }: StorySliderProps) => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="relative"
    >
      <Swiper
        slidesPerView={"auto"}
        spaceBetween={20}
        modules={[Pagination]}
        pagination={{
          clickable: true,
        }}
        className="blue-bullets select-none"
      >
        {data.map((item, index) => (
          <SwiperSlide key={`${item.id}-${index}`} className="!w-fit">
            <button
              type="button"
              className="w-20 md:w-32 lg:w-40 aspect-square shrink-0\ p-0.5 rounded-full border-2 border-blue-main"
            >
              <Image
                src={item.thumbnail}
                alt={`Story image - ${item.id}`}
                width={160}
                height={160}
                className="size-full object-cover rounded-full"
                placeholder="blur"
                blurDataURL={item.thumbnail}
              />
            </button>
          </SwiperSlide>
        ))}
      </Swiper>
    </motion.div>
  );
};

type MapProps = PropsWithClassName;
const Map = ({ className }: MapProps) => {
  const region = useRegionStore((state) => state.region);
  const setRegion = useRegionStore((state) => state.setRegion);
  const t = useTranslations("regions");
  const [hoveredRegion, setHoveredRegion] = useState<string | null>(null);
  const [position, setPosition] = useState({ x: 0, y: 0 });

  const updatePosition = (e: React.MouseEvent<HTMLDivElement>) => {
    const rect = (e.currentTarget as HTMLElement).getBoundingClientRect();
    setPosition({
      x: e.clientX - rect.left,
      y: e.clientY - rect.top,
    });
  };

  const regs: {
    id: RegionKey;
    title: string;
    d: string;
  }[] = [
    {
      id: "tash_reg",
      title: t("tashkent_region"),
      d: "M712.503 237.272C712.11 236.487 711.384 235.957 711.188 235.544C710.991 235.152 709.872 233.954 709.539 233.895C709.205 233.837 704.906 232.777 704.906 232.777L700.999 233.974C700.999 233.974 697.368 238.077 696.897 238.214C696.425 238.352 692.519 238.352 692.205 238.744C691.871 239.137 687.965 249.07 687.827 249.266C687.69 249.462 683.057 249.6 683.057 249.6L681.801 246.812C681.801 246.812 679.818 244.888 679.622 244.888C679.426 244.888 678.424 244.888 677.777 245.556C677.109 246.223 672.673 247.617 672.555 247.813C672.418 248.01 672.555 253.369 672.555 253.369L670.376 253.958C670.376 253.958 668.982 254.959 668.786 255.607C668.59 256.274 666.47 258.846 666.332 259.12C666.195 259.376 664.801 261.829 664.801 261.829H662.818C662.818 261.829 662.092 262.948 661.817 263.282C661.562 263.616 661.032 264.813 660.62 265.127C660.227 265.461 659.697 265.854 659.089 265.52C658.5 265.186 657.165 264.205 656.968 264.401C656.772 264.597 656.576 267.051 656.38 267.522C656.183 267.993 654.318 269.78 654.063 269.976C653.808 270.172 653.199 270.761 652.669 270.565C652.139 270.369 649.764 270.702 648.9 270.604C648.037 270.506 645.269 271.232 644.66 271.625C644.071 272.018 641.676 272.685 641.029 273.156C640.381 273.627 638.967 273.824 638.712 274.275C638.457 274.727 635.14 280.027 635.14 280.027H631.508C631.508 280.027 630.585 281.087 630.31 281.558C630.055 282.029 630.114 282.677 630.369 283.285C630.625 283.874 632.097 286.073 632.097 286.073C632.097 286.073 630.566 285.877 629.722 286.073C628.858 286.269 627.405 285.739 627.268 286.073C627.13 286.407 626.541 287.074 626.208 287.388C625.874 287.722 624.147 287.781 624.147 287.781C624.147 287.781 623.361 286.524 622.498 286.466C621.634 286.407 618.65 286.799 618.591 287.054C618.532 287.31 618.395 291.491 618.395 291.491L616.275 291.098L615.686 293.159L613.428 292.826C613.428 292.826 612.113 292.885 611.897 293.159C611.681 293.434 611.505 294.553 611.563 294.887C611.622 295.221 612.349 295.888 612.427 296.34C612.486 296.811 611.956 297.4 611.505 297.733C611.033 298.067 610.189 297.674 610.975 298.322C611.76 298.99 612.368 299.107 612.231 299.853C612.094 300.58 597.41 312.437 597.41 312.437C597.41 312.437 597.547 313.3 597.665 313.968C597.803 314.635 599.196 315.361 599.059 315.891C598.922 316.421 599.196 317.423 598.333 317.481C597.665 317.54 596.939 317.501 596.173 317.854C595.859 319.503 595.545 321.388 595.604 321.682C595.741 322.252 595.349 323.626 595.604 324.156C595.859 324.686 600.099 326.806 600.512 327.473C600.904 328.141 603.692 328.926 604.222 329.731C604.752 330.516 606.342 332.381 606.872 333.166C607.402 333.951 609.247 336.209 609.247 336.209H610.307C610.307 336.209 612.82 338.054 613.625 338.996C614.41 339.919 613.625 342.903 613.625 342.903V345.219L614.881 346.947L615.47 351.579C615.47 351.579 616.923 354.367 616.53 354.367C616.137 354.367 614.881 357.743 614.881 357.743L619.16 363.593C619.16 363.593 619.219 363.593 619.239 363.593C619.965 363.574 623.832 364.261 623.832 364.261L625.03 364.437V361.355L622.988 360.256L622.399 358.018C622.399 358.018 624.088 358.509 624.284 358.568C624.48 358.627 625.481 358.47 625.481 358.47L626.522 355.78L625.089 353.837C625.089 353.837 624.637 351.148 624.637 350.951C624.637 350.755 623.302 348.478 623.302 348.478L623.244 345.749L620.024 342.883L622.812 340.331L626.129 340.39L626.522 331.851L626.914 330.948L626.365 329.319L627.268 328.121L628.014 327.277H631.292L634.021 327.866C634.021 327.866 635.866 328.867 635.905 329.063C635.964 329.26 637.24 331.655 637.24 331.655L638.83 332.695L640.459 334.03L640.852 336.405L644.071 336.503L646.113 334.717L647.86 332.028L649.548 331.537C649.548 331.537 650.49 330.496 650.687 330.496C650.883 330.496 653.514 330.595 653.514 330.595L662.308 326.57V323.881L664.585 322.841L665.625 323.39C665.625 323.39 667.51 322.546 667.608 322.389C667.706 322.232 670.199 319.916 670.337 319.857C670.474 319.798 673.811 318.816 673.811 318.816C673.811 318.816 673.713 314.655 673.811 314.301C673.909 313.948 673.752 311.828 673.811 311.612C673.851 311.475 675.048 310.768 675.892 310.277L674.381 306.646C674.381 306.646 672.123 302.68 672.123 302.013C672.123 301.345 671.2 291.825 671.2 291.825L675.205 284.601L673.713 283.285L671.652 282.559C671.652 282.559 670.729 280.91 670.258 280.832C669.787 280.773 668.668 279.713 668.413 280.243C668.158 280.773 666.568 281.499 666.097 281.499C665.625 281.499 664.173 281.499 663.78 281.165C663.388 280.832 662.465 279.634 662.72 279.183C662.975 278.712 663.78 277.396 663.78 277.396L664.114 274.805L667.235 274.275C667.235 274.275 668.433 272.685 668.629 272.626C668.825 272.567 670.886 271.9 670.886 271.9C670.886 271.9 672.005 270.251 672.202 270.055C672.398 269.858 674.047 268.072 674.655 267.601C675.244 267.13 676.638 266.874 676.638 266.874L678.169 263.439L679.485 261.712L681.938 260.181L682.076 258.06L684.981 257.275C684.981 257.275 684.647 255.881 685.315 255.43C685.982 254.959 687.042 254.645 687.827 254.645C688.613 254.645 690.536 254.586 691.204 254.507C691.871 254.448 692.99 252.858 692.99 252.858L693.775 250.797L695.228 249.207L696.877 248.952C696.877 248.952 697.8 249.345 698.074 248.618C698.33 247.892 698.663 246.773 698.86 246.498C699.056 246.243 700.646 245.968 701.039 245.438C701.431 244.908 701.961 244.516 702.688 243.789C703.414 243.063 703.944 242.199 704.533 242.003C705.122 241.807 708.832 240.884 709.107 240.688C709.382 240.491 711.03 240.158 711.286 239.569C711.541 238.98 712.876 238.116 712.483 237.311L712.503 237.272Z",
    },
    {
      id: "surkh",
      title: t("surkhandarya"),
      d: "M539.696 452.97L537.969 459.723H531.746L518.77 482.101L506.187 489.247L496.608 503.145C497.02 503.322 497.354 503.439 497.432 503.479C497.727 503.577 501.103 505.658 501.103 505.658L501.79 509.132L499.101 509.623L494.429 517.377L494.625 522.147L493.84 526.819L493.644 533.081L496.235 536.556L492.27 540.619L494.449 543.309L496.922 542.523L499.709 545.213L501.79 543.132L510.035 543.525L515.001 540.639L517.082 541.542L518.672 541.738L522.147 543.23L522.736 546.607V548.393L526.897 549.394L530.176 553.87L538.911 550.788L541.385 548.099L543.073 548.687L544.957 550.67L546.842 550.572L548.236 550.278L549.021 550.768L550.905 550.866L552.79 551.161L555.872 553.85C554.871 552.319 556.912 550.14 557.639 548.962C558.483 547.549 558.915 545.409 558.463 543.721C557.972 541.856 557.069 539.854 557.167 537.871C557.266 535.83 558.129 533.572 558.934 531.707C559.327 530.785 559.621 529.725 560.171 528.88C560.681 528.095 561.525 527.506 562.134 526.8C562.919 525.897 563.312 524.778 563.96 523.816C564.607 522.874 565.393 522.108 565.942 521.087C566.747 519.615 567.238 518.005 567.945 516.474C568.553 515.139 569.574 514.177 570.222 512.901C570.85 511.704 571.36 510.389 571.458 509.034C571.498 508.543 571.242 507.68 571.458 507.228C571.772 506.541 572.224 506.816 573.009 506.777C574.265 506.718 575.502 506.247 576.641 506.639C577.603 506.973 578.506 508.641 579.33 507.542C580.155 506.423 579.605 504.774 579.507 503.597C579.389 502.242 580.056 501.398 580.999 500.534C581.352 500.22 581.725 499.847 582.078 499.533C582.392 499.258 582.589 498.689 582.903 498.394C583.237 498.08 583.708 497.825 583.943 497.413C584.355 496.726 584.336 495.548 584.414 494.743C584.552 493.507 585.416 490.64 584.395 489.777C583.865 489.345 583.629 489.6 583.629 488.717C583.629 488.147 583.845 487.617 583.825 487.068C583.551 487.068 583.099 486.97 582.844 487.068C582.55 487.166 582.334 487.559 581.961 487.657C581.175 487.853 580.606 487.382 580.214 486.793C579.389 485.615 580.272 483.986 579.389 482.867C578.82 482.16 578.309 482.356 577.465 482.455C576.484 482.553 576.13 481.964 575.6 481.218C574.737 479.981 573.461 478.018 571.89 477.606C570.732 477.311 570.398 477.999 569.338 478.214C568.357 478.411 568.612 477.449 568.769 476.683C569.122 475.074 570.987 474.072 570.516 472.188C570.281 471.285 569.456 470.303 568.965 469.499C568.416 468.556 567.944 467.967 568.023 466.829C568.102 465.749 568.494 464.709 568.592 463.629C568.73 462.216 568.475 461.273 567.729 460.056C567.257 459.291 566.983 458.977 567.866 458.466C568.357 458.172 568.926 458.015 569.476 457.877C570.516 457.603 571.164 457.171 570.398 456.15C569.966 455.561 569.554 454.972 569.142 454.383C568.848 453.971 568.357 453.618 568.102 453.205C567.513 452.224 569.495 451.674 570.3 451.596C570.83 451.537 571.184 451.537 571.635 451.262C572.518 450.752 574.05 450.025 573.912 448.887C573.834 448.259 573.52 447.827 573.618 447.159C573.716 446.57 574.364 445.981 574.344 445.451C574.324 444.804 573.618 444.607 573.147 444.352C572.597 444.058 572.185 443.822 571.772 443.331C570.85 442.212 570.536 440.269 569.044 439.719C568.239 439.425 567.473 439.445 566.727 439.818C566.237 440.073 566.001 440.269 565.393 440.191C564.725 440.112 564.568 439.719 564.077 439.307C563.371 438.718 562.644 438.757 561.781 439.032C560.838 439.327 560.132 439.15 559.405 439.798C558.64 440.485 557.953 440.917 556.853 440.701C555.617 440.485 554.635 439.602 553.438 440.249C553.025 440.485 552.731 440.917 552.221 441.093C551.435 441.368 550.395 441.329 549.845 440.662C549.178 439.857 548.883 438.561 548.825 437.54C548.805 437.05 548.805 436.559 548.805 436.068L537.596 442.801L539.579 452.989L539.696 452.97Z",
    },
    {
      id: "sir",
      title: t("syrdarya"),
      d: "M614.841 357.704C614.841 357.704 616.098 354.328 616.49 354.328C616.883 354.328 615.43 351.54 615.43 351.54L614.841 346.908L613.585 345.18V342.864C613.585 342.864 614.37 339.88 613.585 338.957C612.8 338.035 610.268 336.17 610.268 336.17H609.208C609.208 336.17 607.362 333.912 606.832 333.127C606.302 332.342 604.712 330.477 604.182 329.692C603.652 328.907 600.865 328.102 600.472 327.434C600.079 326.767 595.839 324.647 595.564 324.117C595.309 323.587 595.702 322.193 595.564 321.643C595.486 321.329 595.82 319.445 596.134 317.815C595.937 317.914 595.721 318.012 595.505 318.169C594.504 318.895 594.112 319.288 593.719 318.895C593.327 318.502 592.934 318.228 593.052 317.305C593.189 316.382 591.521 316.52 591.462 315.774C591.403 315.047 592.522 314.38 591.207 314.38C589.891 314.38 588.497 313.909 588.223 314.576C587.967 315.244 586.907 314.773 586.436 315.44C585.965 316.108 585.317 317.03 585.573 317.619C585.828 318.208 585.631 318.012 586.77 318.738C587.889 319.464 589.027 319.739 589.145 319.994C589.283 320.25 590.794 320.78 590.794 321.192C590.794 321.604 590.598 334.109 590.598 334.109C590.598 334.109 591.324 334.246 591.795 334.442C592.267 334.639 594.171 337.348 594.171 337.348C594.171 337.348 595.093 339.468 594.897 340.253C594.701 341.038 590.402 342.844 590.402 342.844C590.402 342.844 587.752 342.451 587.496 342.373C587.241 342.314 585.435 341.843 585.435 341.843L577.073 336.621L575.306 340.783L568.749 339.782V342.824L572.322 347.123L574.913 348.91L571.537 354.269C571.537 354.269 567.768 358.431 567.375 359.039C566.983 359.628 565.196 361.513 565.196 361.513V364.339L566.786 367.559L569.966 368.756L575.522 371.74L582.078 373.134L596.782 376.314L604.693 375.057C604.202 373.899 603.829 373.036 603.829 373.036L606.518 373.939L607.362 373.153L608.992 373.055L609.914 372.643L611.544 371.249L612.093 369.129L611.877 367.186C611.877 367.186 610.346 367.303 610.268 367.343C610.189 367.362 608.089 367.991 607.794 368.069C607.5 368.148 605.046 368.972 604.869 369.09C604.693 369.208 601.885 370.562 601.807 370.601C601.728 370.66 600.668 371.387 600.236 371.504C599.805 371.622 596.036 371.19 595.996 371.249C595.937 371.328 595.407 372.309 594.995 372.309L591.992 371.877L588.91 370.837L588.713 369.031C588.713 369.031 599.275 364.987 599.333 365.026C599.412 365.085 600.806 366.773 600.806 366.773C600.806 366.773 602.906 366.145 602.965 365.929C603.024 365.713 604.025 364.418 604.594 364.261C605.164 364.104 608.717 363.397 609.208 363.24C609.698 363.083 612.525 362.808 613.408 362.887C614.253 362.965 618.257 363.495 619.121 363.515L614.841 357.665V357.704Z",
    },
    {
      id: "sam",
      title: t("samarkand"),
      d: "M432.025 408.154L442.939 414.809L448.494 413.71L454.246 415.3L464.179 420.266L472.129 421.365L484.339 415.908L493.88 420.678L497.452 415.319L507.189 416.909V423.073L514.629 422.602L516.514 417.714L533.121 422.602C533.101 421.797 535.221 421.562 535.849 421.424C537.204 421.13 540.463 421.189 539.736 418.912L535.575 417.263L526.564 403.364L525.367 399.792L527.212 395.159L530.647 392.116L535.673 389.211L535.005 382.988L531.57 381.398L513.962 378.355L507.346 371.858L509.604 366.95L507.346 361.12L506.424 349.342L496.432 346.633L491.662 345.632L484.712 345.239C484.712 345.239 481.729 349.204 481.14 349.204C480.551 349.204 470.225 347.771 470.225 347.771C470.225 347.771 464.866 348.419 464.866 349.204C464.866 349.99 464.277 354.367 464.866 354.956C465.455 355.545 466.26 365.085 466.26 365.085L464.611 370.641L459.311 375.607L453.755 373.232L445.412 375.607H432.908L434.891 384.951L428.727 388.916H424.153L421.365 390.507L423.152 396.474L426.135 398.653L427.333 402.815L422.366 411.354L428.53 412.041L432.005 408.174L432.025 408.154Z",
    },
    {
      id: "kashk",
      title: t("kashkadarya"),
      d: "M548.923 436.049C548.923 435.224 548.903 434.4 548.727 433.556C548.648 433.183 548.609 432.672 548.373 432.358C548 431.887 547.195 431.809 546.744 431.357C546.292 430.906 545.959 430.218 545.448 429.806C544.82 429.296 543.858 429.374 543.073 429.414C542.17 429.472 541.247 429.531 540.344 429.414C539.657 429.335 539.284 429.001 538.597 428.825C537.812 428.609 536.929 428.393 536.104 428.354C536.085 427.431 534.023 427.47 533.454 427.117C532.257 426.371 534.004 424.899 533.749 423.78C533.65 423.367 533.12 422.936 533.12 422.602L516.513 417.714L514.629 422.602L507.189 423.073V416.909L497.452 415.319L493.879 420.678L484.339 415.908L472.129 421.365L464.179 420.266L454.246 415.299L448.494 413.709L442.939 414.809L432.024 408.154L428.55 412.021L422.386 411.334L407.683 423.446L408.88 430.395L385.834 439.739L399.732 453.245L410.863 460.999L414.828 462.196L418.401 465.769H420.992L429.139 474.112L445.432 485.242L459.723 488.226V486.832L464.885 486.636L466.083 489.424H469.656C469.656 489.424 476.134 494.39 476.565 494.39H479.589C479.589 494.39 480.177 492.996 480.59 494.39C480.982 495.784 480.59 496.765 480.59 496.765L486.655 501.339L489.737 502.124L492.113 501.123L494.095 502.124C494.095 502.124 495.627 502.772 496.647 503.184L506.227 489.286L518.81 482.141L531.786 459.762H538.008L539.736 453.009L537.753 442.821L548.962 436.088L548.923 436.049Z",
    },
    {
      id: "nav",
      title: t("navoi"),
      d: "M426.155 398.613L423.171 396.434L421.385 390.467L424.172 388.877H428.746L434.91 384.911L432.927 375.567H445.432L453.775 373.192L459.33 375.567L464.63 370.601L466.279 365.046C466.279 365.046 465.494 355.505 464.886 354.916C464.297 354.327 464.886 349.95 464.886 349.165C464.886 348.379 470.245 347.732 470.245 347.732C470.245 347.732 480.57 349.165 481.159 349.165C481.748 349.165 484.732 345.199 484.732 345.199L491.681 345.592L496.451 346.593L502.007 329.907L499.828 321.172H493.86L501.005 306.802L493.585 260.259L468.419 256.293L468.753 229.341L473.327 230.735L474.112 193.064L463.119 198.168L449.476 170.155L433.183 157.847L424.899 143.223C424.899 143.223 423.446 141.907 422.975 141.77C422.504 141.633 420.855 141.515 420.462 141.966C420.07 142.437 403.305 151.173 403.305 151.173L345.572 142.83L309.492 147.934L287.251 147.738L289.233 167.662L303.014 171.373L274.412 221.43L272.292 237.311L276.788 248.971L267.777 256.392L281.244 280.419L299.363 276.513L310.689 295.77L317.442 298.361L320.819 312.26L351.795 324.568L354.779 332.911L362.533 330.732L369.678 319.601L388.543 329.731L393.117 324.568L401.46 324.764L406.623 319.601L411.589 332.106L437.403 339.251L436.206 349.381H426.469V356.722L424.29 359.902L409.391 354.936L407.997 361.1L412.374 364.673L404.032 374.998L392.705 382.34V383.734L396.67 391.488H404.012L413.552 396.454L415.142 404.208L422.288 411.354L427.254 402.814L426.057 398.653L426.155 398.613Z",
    },
    {
      id: "nam",
      title: t("namangan"),
      d: "M754.552 297.124L752.706 299.244L751.254 299.715L749.271 298.184L747.151 298.577C747.151 298.577 745.423 298.106 745.09 298.106C744.756 298.106 742.97 297.242 743.029 296.908C743.087 296.575 743.892 293.061 743.892 293.061C743.892 293.061 743.637 290.273 743.421 289.822C743.225 289.351 742.832 286.916 742.832 286.916L742.361 285.385C742.361 285.385 741.105 286.17 740.575 285.856C740.045 285.523 738.455 282.087 738.455 282.087C738.455 282.087 738.455 280.105 737.728 280.694C737.002 281.282 735.471 282.009 735.471 282.009C735.471 282.009 734.686 280.615 734.47 281.616C734.273 282.617 734.332 283.736 733.802 283.206C733.272 282.676 733.41 280.831 733.41 280.831L734.725 278.907C734.725 278.907 734.862 276.728 734.725 276.257C734.588 275.786 733.861 274.196 733.665 274.333C733.469 274.471 731.82 276.12 731.682 276.787C731.545 277.455 731.545 278.515 730.956 278.574C730.367 278.632 729.562 278.515 729.562 278.711C729.562 278.907 730.956 279.241 731.152 279.712C731.349 280.183 731.29 282.303 731.29 282.755C731.29 283.206 731.152 285.601 731.093 286.131C731.034 286.661 730.76 287.721 730.426 287.918C730.092 288.114 728.973 289.036 728.777 289.508C728.581 289.979 729.032 290.509 727.992 290.705C726.932 290.901 725.342 290.764 725.342 290.764C725.342 290.764 723.948 290.175 723.222 290.568C722.495 290.96 721.573 290.823 721.573 292.55C721.573 294.278 723.025 295.534 723.104 295.927C723.163 296.319 723.163 297.242 722.966 297.576C722.77 297.909 721.573 297.713 722.495 298.361C723.418 299.028 724.026 298.695 723.28 299.892C722.554 301.09 721.553 302.405 721.435 302.68C721.298 302.935 720.12 300.226 720.12 300.226C720.12 300.226 719.59 298.773 719.197 299.028C718.805 299.284 717.018 298.891 717.136 300.088C717.254 301.286 716.94 301.678 716.606 301.541C716.272 301.404 714.29 299.362 714.427 298.832C714.565 298.302 713.642 297.105 713.505 297.968C713.367 298.832 713.249 299.814 712.582 299.087C711.914 298.361 711.326 297.556 710.521 298.165C709.736 298.753 708.99 299.362 708.675 299.951C708.342 300.54 707.085 300.952 707.085 300.952L704.298 298.891C704.298 298.891 702.178 298.636 701.982 299.146C701.785 299.676 701.314 300.677 701.314 300.677L695.759 295.318C695.759 295.318 694.031 295.456 693.639 295.986C693.246 296.516 692.245 298.106 692.323 298.302C692.382 298.498 691.597 298.969 691.597 298.969C691.597 298.969 691.401 293.669 691.46 293.336C691.519 293.002 691.931 289.488 691.852 289.233C691.793 288.978 690.93 286.779 690.655 286.386C690.4 285.994 688.81 283.874 688.672 283.677C688.535 283.481 687.416 281.891 687.416 281.891C687.416 281.891 683.117 282.225 682.92 282.48C682.724 282.735 681.527 284.011 681.33 284.541C681.134 285.071 679.681 286.602 679.348 286.72C679.014 286.857 677.287 286.465 677.287 286.465L675.206 284.6L671.201 291.824C671.201 291.824 672.124 301.364 672.124 302.012C672.124 302.66 674.381 306.645 674.381 306.645L675.893 310.277C676.344 310.021 676.678 309.825 676.678 309.825L679.367 309.923L680.27 311.906L681.271 312.259L683.215 311.611L687.73 316.126L684.844 314.693L682.803 313.162C682.803 313.162 682.508 313.417 682.508 313.849C682.508 314.281 684.589 317.579 685.041 318.129C685.492 318.678 690.792 323.252 690.792 323.252C690.792 323.252 690.851 323.507 690.341 323.547C689.85 323.606 688.201 322.349 688.201 322.349L688.142 325.176C688.142 325.176 689.987 325.529 690.38 325.765C690.773 326.02 693.501 327.1 693.599 327.394C693.639 327.512 693.639 327.826 693.639 328.14L698.468 327.492L708.891 330.378L712.17 331.968C712.17 331.968 716.135 330.084 716.135 329.73C716.135 329.377 720.905 322.231 720.905 322.231L726.971 321.642L728.659 317.579L734.725 316.578L739.593 313.496H744.854L751.116 314.693L753.492 311.317L756.927 297.301L754.552 297.105V297.124Z",
    },
    {
      id: "kar",
      title: t("karakalpakstan"),
      d: "M198.069 237.272H202.172L206.942 238.999L208.395 240.589V243.769C208.395 243.769 209.18 245.359 209.592 245.497C209.985 245.634 210.79 246.164 211.045 247.087C211.3 248.009 211.182 250.208 211.712 250.306C212.242 250.404 214.362 251.209 214.362 251.209C214.362 251.209 216.208 251.994 216.345 253.054C216.482 254.114 217.13 255.43 217.405 256.372C217.66 257.294 220.978 259.022 220.978 259.022C220.978 259.022 221.115 260.082 221.763 261.142C222.411 262.202 222.823 261.535 224.021 262.732C225.218 263.93 226.141 264.322 226.808 265.107C227.475 265.893 227.338 266.167 228.261 267.09C229.183 268.013 230.636 269.21 231.166 270.27C231.696 271.33 231.833 271.723 232.756 272.783C233.679 273.843 236.329 274.235 236.604 275.04C236.859 275.826 237.919 276.238 239.254 277.16C240.589 278.083 243.494 278.476 244.024 278.476C244.554 278.476 250.109 277.808 250.914 277.808C251.719 277.808 255.822 276.493 255.822 276.493C255.822 276.493 260.062 278.613 260.454 279.143C260.847 279.673 263.497 279.928 263.497 279.928L266.54 280.851L267.266 283.324L269.249 284.914L271.232 287.996L273.509 291.176L276.061 295.456L278.671 299.323L281.537 302.346L284.07 301.384L291.49 298.538L267.855 256.372L276.865 248.952L272.37 237.291L274.49 221.41L303.092 171.353L289.311 167.643L287.328 147.718L250.914 99.0542V90.4561L206.294 46.759L147.305 0.784698L0.78418 21.5732V249.58L47.7989 261.77V257.393L52.2942 256.863L53.7469 256.333C53.7469 256.333 54.5321 254.487 53.7469 254.35C52.9616 254.213 50.4293 253.427 50.3116 253.035C50.1741 252.642 49.1141 250.522 49.1141 250.129C49.1141 249.737 49.3693 244.574 49.3693 244.574C49.3693 244.574 50.0367 241.669 49.6245 240.726C49.2319 239.804 48.8393 238.214 48.3093 237.291C47.7792 236.369 47.1118 235.976 47.2492 234.916C47.3866 233.856 47.6418 231.736 47.9166 230.676C48.1915 229.616 48.9767 223.648 48.9767 223C48.9767 222.352 49.1141 221.018 49.1141 221.018C49.1141 221.018 50.8416 220.488 51.2342 220.35C51.6268 220.213 56.6718 220.35 56.6718 220.35L64.7399 208.572L77.8529 209.495L82.2305 210.28C82.2305 210.28 87.1381 210.025 87.6681 210.025C88.1981 210.025 91.2408 209.887 91.2408 209.887L90.3182 205.392L93.2235 207.119L96.541 201.034C96.541 201.034 96.7962 199.189 96.541 198.659C96.2858 198.129 94.951 195.223 94.951 195.223C94.951 195.223 95.2062 194.163 95.6184 194.026C96.011 193.888 97.8759 194.026 97.8759 194.026C97.8759 194.026 98.1311 192.573 98.4059 192.181C98.6611 191.788 99.4659 190.453 99.4659 190.453H100.919L102.116 188.608L103.569 190.591L105.826 191.376L106.749 193.751L113.757 195.479L115.484 197.991L116.407 203.684V205.529L117.997 207.257L121.962 207.001V203.821L117.585 200.111L116.27 195.616L113.757 189.256L107.789 185.153L107.534 182.895L113.227 180.383L127.4 184.878V181.031L129.913 180.363L129.245 178.38L129.913 175.73L146.206 195.066L154.019 195.851L157.454 205.392L164.992 212.145L177.968 213.067L180.088 214.795L183.661 212.95L185.388 212.694V216.267L189.353 217.327L191.199 222.765L186.821 223.687L191.199 227.26L189.883 232.815L184.858 232.678L186.978 235.583L189.883 235.976L190.669 238.881L193.849 239.274V239.313L194.771 238.626L198.089 237.311L198.069 237.272Z",
    },
    {
      id: "khor",
      title: t("khorezm"),
      d: "M292.099 309.845L284.09 301.365L281.557 302.327L278.691 299.304L276.08 295.437L273.529 291.157L271.251 287.977L269.269 284.895L267.286 283.305L266.56 280.832L263.517 279.909C263.517 279.909 260.867 279.654 260.474 279.124C260.082 278.594 255.842 276.474 255.842 276.474C255.842 276.474 251.739 277.789 250.934 277.789C250.129 277.789 244.574 278.456 244.044 278.456C243.514 278.456 240.608 278.064 239.274 277.141C237.939 276.218 236.898 275.826 236.623 275.021C236.368 274.236 233.718 273.824 232.776 272.763C231.853 271.703 231.716 271.311 231.186 270.251C230.656 269.191 229.203 267.993 228.281 267.071C227.358 266.148 227.495 265.873 226.828 265.088C226.16 264.303 225.238 263.891 224.04 262.713C222.843 261.515 222.45 262.183 221.783 261.123C221.115 260.063 220.998 259.003 220.998 259.003C220.998 259.003 217.68 257.275 217.425 256.353C217.17 255.43 216.502 254.095 216.365 253.035C216.228 251.975 214.382 251.19 214.382 251.19C214.382 251.19 212.262 250.405 211.732 250.287C211.202 250.189 211.34 248.01 211.065 247.067C210.81 246.145 210.005 245.615 209.612 245.477C209.219 245.34 208.415 243.75 208.415 243.75V240.57L206.962 238.98L202.192 237.252H198.089L194.772 238.567L193.849 239.254L196.224 244.653L198.874 245.438L202.192 249.148L200.072 251.406L196.106 246.636L191.336 245.045L189.079 249.148L194.379 258.944L192.004 260.789L188.568 268.327L206.452 284.09L213.597 282.893C213.597 282.893 220.095 282.893 220.605 283.03C221.115 283.168 231.068 284.09 231.068 284.09L231.991 286.465C231.991 286.465 232.658 282.225 232.913 282.755C233.169 283.285 238.744 290.823 238.744 290.823L242.454 292.021H247.361L249.481 289.763C249.481 289.763 250.149 285.268 250.149 284.856C250.149 284.444 251.739 283.403 251.739 283.403L254.919 283.796L262.594 287.898L270.937 295.967L276.1 304.172V315.028L280.556 329.515C283.834 326.786 289.861 322.173 289.861 322.173L293.709 315.165L292.118 309.727L292.099 309.845Z",
    },
    {
      id: "jiz",
      title: t("jizzakh"),
      d: "M582.079 373.192L575.522 371.799L569.967 368.815L566.787 367.617L565.197 364.398V361.571C565.197 361.571 566.983 359.687 567.376 359.098C567.768 358.509 571.537 354.328 571.537 354.328L574.914 348.969L572.323 347.182L568.75 342.883V339.84L575.306 340.842L577.073 336.68L565.177 329.26L560.544 327.729C560.544 327.729 559.151 327.257 559.484 326.943C559.818 326.629 560.878 324.686 561.016 324.49C561.153 324.293 564.726 324.097 564.726 324.097C564.726 324.097 565.648 322.114 565.786 321.584C565.923 321.054 566.983 318.797 567.101 318.6C567.238 318.404 566.237 316.755 566.178 316.421C566.119 316.088 566.041 314.635 566.041 314.635C566.041 314.635 568.416 313.968 568.357 313.516C568.298 313.065 567.042 311.592 567.042 311.592C567.042 311.592 566.571 309.747 565.923 311.592C565.256 313.438 564.137 314.831 563.018 314.38C561.899 313.909 561.173 314.046 561.29 313.457C561.428 312.868 561.035 306.371 561.035 306.371C561.035 306.371 559.111 307.49 558.915 307.49C558.719 307.49 556.402 307.882 556.128 307.745C555.872 307.607 550.101 304.31 550.101 304.31L533.219 308.02L501.045 306.822L493.899 321.192H499.867L502.046 329.927L496.491 346.613L506.482 349.322L507.405 361.1L509.663 366.93L507.405 371.838L514.021 378.336L531.629 381.378L535.064 382.968L535.732 389.191L530.706 392.096L527.271 395.139L525.426 399.772L526.623 403.345L535.633 417.243L539.795 418.892L538.558 415.673L538.009 412.885C538.009 412.885 537.165 411.197 537.008 411C536.851 410.804 535.123 408.527 535.123 408.527L537.812 407.624L537.42 405.936C537.42 405.936 537.577 405.249 538.166 405.249C538.755 405.249 540.993 404.562 541.189 404.562C541.385 404.562 545.409 403.777 545.409 403.777L547.353 402.088L549.826 399.85L552.359 400.793L554.145 400.204C554.145 400.204 559.897 403.089 560.054 403.188C560.211 403.286 562.134 403.443 562.134 403.443C562.134 403.443 562.92 403.148 563.077 403.188C563.234 403.247 567.356 405.033 567.356 405.033C567.356 405.033 569.143 405.524 569.3 405.524C569.457 405.524 571.243 405.268 571.675 405.327C572.126 405.386 573.756 405.524 574.148 405.72C574.541 405.916 576.975 405.916 577.171 405.916C577.368 405.916 578.506 405.857 579.017 406.113C579.507 406.368 581.843 407.506 581.843 407.506C581.843 407.506 583.59 406.917 583.728 406.917C583.865 406.917 586.26 407.271 586.26 407.271L589.637 406.976L590.324 406.073C590.324 406.073 589.48 404.542 589.538 404.228C589.597 403.934 590.873 402.54 591.286 402.344C591.678 402.147 593.465 400.596 593.523 400.263C593.582 399.909 594.073 398.319 593.818 397.927C593.563 397.534 592.679 395.591 592.679 395.335C592.679 395.08 593.68 393.804 593.68 393.804L593.896 390.33V387.012C593.896 387.012 595.369 387.699 595.624 387.699C595.879 387.699 597.607 386.796 597.607 386.796L598.647 386.6L599.55 385.069L600.885 387.307L602.023 385.618C602.023 385.618 603.123 385.265 603.319 384.185C603.515 383.106 603.319 379.612 603.319 379.612L604.948 385.461C604.948 385.461 607.422 383.871 607.638 383.518C607.834 383.165 607.932 381.928 607.638 381.634C607.441 381.437 605.773 377.609 604.732 375.155L596.821 376.412L582.118 373.232L582.079 373.192Z",
    },
    {
      id: "fer",
      title: t("fergana"),
      d: "M756.927 332.381L753.001 333.775L748.937 334.069L747.936 333.481L741.183 333.579L739.397 331.694L738.199 328.71L726.991 321.663L720.925 322.252C720.925 322.252 716.155 329.397 716.155 329.751C716.155 330.104 712.189 331.989 712.189 331.989L708.911 330.399L698.487 327.513L693.658 328.161C693.658 328.651 693.619 329.201 693.619 329.201C693.619 329.201 691.636 331.086 691.577 331.341C691.519 331.596 691.381 332.735 691.381 332.735L690.282 332.892L685.119 337.308C685.119 337.308 685.119 338.408 684.962 338.604C684.805 338.8 683.922 338.997 683.627 339.056C683.333 339.114 682.528 339.154 682.332 339.35C682.135 339.546 681.291 339.998 681.291 340.194C681.291 340.39 680.997 341.882 680.997 342.039C680.997 342.196 677.424 344.218 677.169 344.415C676.914 344.611 673.145 346.005 673.145 346.005L674.44 349.734L679.21 352.208L684.334 352.012L685.178 359.216L687.867 362.2L693.423 362.043C693.423 362.043 695.602 361.14 695.857 361.042C696.112 360.943 699.43 359.452 699.43 359.452C699.43 359.452 701.864 359.294 702.413 359.452C702.963 359.609 704.749 359.452 704.749 359.452L703.199 355.604L708.558 354.819L711.541 351.501C711.541 351.501 716.037 350.579 716.233 350.716C716.429 350.853 717.352 351.972 717.352 351.972L718.412 351.05L719.472 352.443L721.003 352.385L722.534 352.247L725.97 354.308H728.954V356.821L734.391 358.274V354.308C734.391 354.308 736.766 353.975 737.041 354.112C737.296 354.249 738.572 357.744 738.572 357.744H736.727L738.18 359.059L739.907 361.513L740.967 359.864L745.738 357.547L745.07 354.564L746.523 353.366L749.565 355.152L751.097 354.151L753.884 353.032L754.748 352.11L751.371 351.109L750.311 349.99L754.748 345.22L755.337 341.509L757.398 341.254L760.048 338.27L758.321 335.188L756.986 332.401L756.927 332.381Z",
    },
    {
      id: "bukh",
      title: t("bukhara"),
      d: "M411.667 332.086L406.7 319.582L401.538 324.745L393.195 324.548L388.621 329.711L369.756 319.582L362.611 330.712L354.857 332.891L351.873 324.548L320.896 312.24L317.52 298.342L310.767 295.751L299.44 276.493L281.321 280.4L291.49 298.538L284.07 301.385L292.079 309.865L293.669 315.302L289.821 322.311C289.821 322.311 283.795 326.924 280.517 329.652L280.831 330.653L283.481 335.149L285.071 336.994L287.054 337.524L289.311 338.191L290.764 344.807L292.609 346.927V362.16L295.396 370.11L351.284 415.535L359.627 421.503L361.413 424.683L379.493 439.779H385.853L408.899 430.434L407.702 423.485L422.405 411.373L415.259 404.228L413.669 396.474L404.129 391.507H396.787L392.822 383.754V382.36L404.149 375.018L412.491 364.692L408.114 361.12L409.508 354.956L424.407 359.922L426.586 356.742V349.4H436.323L437.52 339.271L411.706 332.126L411.667 332.086Z",
    },
    {
      id: "and",
      title: t("andijan"),
      d: "M802.88 313.477C802.487 313.477 796.716 313.418 796.716 313.418L795.185 315.263L794.517 316.657H792.26L789.472 313.221L785.899 314.007L776.359 313.614L776.752 312.083C776.752 312.083 777.144 310.964 776.889 310.63C776.634 310.297 773.65 307.784 773.65 307.784C773.65 307.784 772.394 307.391 772.256 307.058C772.119 306.724 771.923 305.33 771.923 305.33L769.802 304.937C769.802 304.937 769.017 304.407 768.742 304.545C768.487 304.682 766.622 304.8 766.622 304.8L765.032 303.014C765.032 303.014 762.775 304.015 762.657 304.329C762.52 304.663 761.538 306.253 760.93 306.508C760.341 306.763 758.338 307.431 758.024 307.509C757.71 307.588 756.434 307.175 756.434 307.175C756.434 307.175 757.161 305.86 757.357 305.723C757.553 305.585 758.476 304.133 758.476 304.133C758.476 304.133 758.142 302.013 758.005 301.62C757.867 301.227 756.945 297.321 756.945 297.321H756.866L753.431 311.317L751.056 314.694L744.793 313.496H739.533L734.664 316.578L728.598 317.579L726.91 321.643L738.119 328.69L739.317 331.674L741.103 333.559L747.856 333.46L748.857 334.049L752.92 333.755L756.846 332.361L758.181 335.149L759.909 338.231L760.969 339.153L762.5 338.623L762.971 340.017L764.62 341.666L766.269 341.528L768.527 343.256H770.372V341.666C770.372 341.666 770.902 341.077 771.098 340.802C771.294 340.547 771.491 338.093 771.491 338.093L770.961 337.171L768.978 336.582L769.371 335.522L770.234 335.05L770.431 333.46L768.114 332.459L766.662 331.007L768.252 330.614L769.783 329.691L772.963 333.598L774.023 332.871L775.22 333.932L778.656 334.52L779.578 335.973L781.757 335.777L782.425 334.854C782.425 334.854 782.817 333.264 782.425 333.009C782.032 332.754 781.365 331.419 781.365 331.419C781.365 331.419 782.248 330.496 782.602 330.555C782.955 330.614 784.407 331.419 784.407 331.419L785.271 331.085C785.271 331.085 785.86 329.691 785.86 329.358C785.86 329.024 786.194 328.494 786.194 328.298C786.194 328.101 786.724 327.179 786.724 327.179C786.724 327.179 785.998 326.06 785.939 325.726C785.88 325.392 786.076 324.941 786.076 324.941L790.179 324.744L790.513 322.624L793.555 321.368L796.205 318.914L800.112 318.443L802.291 316.794L803.154 315.008C803.154 315.008 803.213 313.477 802.821 313.477H802.88Z",
    },
    {
      id: "tash",
      title: t("tashkent"),
      d: "M651 306C651 312.627 645.627 318 639 318C632.373 318 627 312.627 627 306C627 299.373 632.373 294 639 294C645.627 294 651 299.373 651 306Z",
    },
  ];
  return (
    <div
      className={cn("h-auto relative", className)}
      onMouseEnter={updatePosition}
      onMouseMove={updatePosition}
      onMouseLeave={updatePosition}
    >
      <svg
        width="804"
        height="555"
        viewBox="0 0 804 555"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="w-full h-auto"
      >
        {regs.map((reg) => (
          <path
            key={reg.id}
            d={reg.d}
            stroke="white"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
            className={cn("cursor-pointer transition", {
              "fill-[#005FDF]": region === reg.id,
              "fill-[#90B9F1] hover:fill-[#609BEB]": region !== reg.id,
            })}
            onClick={() => setRegion(reg.id)}
            onMouseEnter={() => setHoveredRegion(reg.title)}
            onMouseLeave={() => setHoveredRegion(null)}
          />
        ))}
      </svg>

      <AnimatePresence>
        {hoveredRegion && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="absolute z-1 -translate-x-1/2 -translate-y-[calc(100%+0.375rem)] pointer-events-none p-2 bg-white rounded-2xl text-center text-sm font-medium"
            style={{
              top: position.y,
              left: position.x,
              opacity: 0.8,
            }}
          >
            {hoveredRegion}
            <div className="absolute inset-x-center -bottom-1.5 rotate-45 size-2 bg-white"></div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
};
